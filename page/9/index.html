<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="what I don&apos;t know">
<meta property="og:type" content="website">
<meta property="og:title" content="Serious Autonomous Vehicles">
<meta property="og:url" content="http://yoursite.com/page/9/index.html">
<meta property="og:site_name" content="Serious Autonomous Vehicles">
<meta property="og:description" content="what I don&apos;t know">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Serious Autonomous Vehicles">
<meta name="twitter:description" content="what I don&apos;t know">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/9/"/>





  <title>Serious Autonomous Vehicles</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Serious Autonomous Vehicles</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/31/æ— è¿¹å¡å°”æ›¼æ»¤æ³¢/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/31/æ— è¿¹å¡å°”æ›¼æ»¤æ³¢/" itemprop="url">æ— è¿¹å¡å°”æ›¼æ»¤æ³¢</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-31T10:29:26-04:00">
                2019-03-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/31/æ— è¿¹å¡å°”æ›¼æ»¤æ³¢/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/31/æ— è¿¹å¡å°”æ›¼æ»¤æ³¢/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>éçº¿æ€§ç³»ç»Ÿï¼š</p>
<pre><code>x = f(x, w)         ï¼ˆ1ï¼‰

z = h(x) + v                 ï¼ˆ2ï¼‰
</code></pre><p>éšæœºä¿¡å· <code>w</code>, <code>v</code>åˆ†åˆ«æ˜¯è¿‡ç¨‹å™ªå£°å’Œè§‚æµ‹å™ªå£°    </p>
<h2 id="CTRV-çŠ¶æ€æ–¹ç¨‹"><a href="#CTRV-çŠ¶æ€æ–¹ç¨‹" class="headerlink" title="CTRV çŠ¶æ€æ–¹ç¨‹"></a>CTRV <a href="https://winfriedauner.de/projects/" target="_blank" rel="external">çŠ¶æ€æ–¹ç¨‹</a></h2><p>å¯¹äºconst turn rate and velocity magnitude (<a href="https://fevemania.github.io/blog/mathematic-formula-note-of-unscented-kalman-filter/" target="_blank" rel="external">CTRV</a> )åœºæ™¯ï¼š</p>
<pre><code>x = (px, py, v, phi, \dot{phi})
</code></pre><p>å›ºå®šé€Ÿåº¦å’Œè½¬åŠ¨é€Ÿç‡çº¦æŸï¼Œå³ï¼š</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=\dot{x}&space;=&space;(\dot{p_x},&space;\dot{p_y},&space;\dot{v},&space;\dot{\psi},&space;\ddot{\psi})&space;=&space;(vcos(\psi&space;),&space;vsin(\psi),&space;0,&space;\dot{\psi},&space;0)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dot{x}&space;=&space;(\dot{p_x},&space;\dot{p_y},&space;\dot{v},&space;\dot{\psi},&space;\ddot{\psi})&space;=&space;(vcos(\psi&space;),&space;vsin(\psi),&space;0,&space;\dot{\psi},&space;0)" title="\dot{x} = (\dot{p_x}, \dot{p_y}, \dot{v}, \dot{\psi}, \ddot{\psi}) = (vcos(\psi ), vsin(\psi), 0, \dot{\psi}, 0)"></a>  </p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=x_{k&plus;1}&space;=&space;x_k&space;&plus;&space;\int_{t_k}^{t_{k&plus;1}}&space;\dot{x}&space;dt&space;&plus;&space;v" target="_blank"><img src="https://latex.codecogs.com/gif.latex?x_{k&plus;1}&space;=&space;x_k&space;&plus;&space;\int_{t_k}^{t_{k&plus;1}}&space;\dot{x}&space;dt&space;&plus;&space;v" title="x_{k+1} = x_k + \int_{t_k}^{t_{k+1}} \dot{x} dt + w"></a>      </p>
<p>è€ƒè™‘ <code>dv/dt == 0</code> , <code>dphi^2\dt^2==0</code> ä¸”<code>\psi</code>æ˜¯æ—¶é—´çš„å‡½æ•°, ä¸Šè¿°ç¬¬ä¸€é¡¹å³ï¼š</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=px_{k&plus;1}&space;=&space;px_k&space;&plus;&space;\int_{t_k}^{t_{k&plus;1}}&space;v&space;cos\psi)&space;dt&space;&plus;&space;v&space;\\&space;=&space;px_k&space;&plus;&space;{\frac{sin\psi}{\dot{\psi}}}_{t_k}^{t_{k&plus;1}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?px_{k&plus;1}&space;=&space;px_k&space;&plus;&space;\int_{t_k}^{t_{k&plus;1}}&space;v&space;cos\psi)&space;dt&space;&plus;&space;v&space;\\&space;=&space;px_k&space;&plus;&space;{\frac{sin\psi}{\dot{\psi}}}_{t_k}^{t_{k&plus;1}}" title="px_{k+1} = px_k + \int_{t_k}^{t_{k+1}} v cos\psi) dt + w \\ = px_k + {\frac{sin\psi}{\dot{\psi}}}_{t_k}^{t_{k+1}}"></a>     </p>
<p>ä»åŸçŠ¶æ€ç©ºé—´åˆ°é¢„æµ‹ç©ºé—´ï¼Œç”±æ–¹ç¨‹ï¼ˆ1),ï¼ˆ2ï¼‰å¯è§ï¼Œè¿‡ç¨‹å™ªå£°<code>w</code>æ˜¯çŠ¶æ€<code>x</code>çš„éçº¿æ€§é¡¹ï¼›è€Œ<code>z</code>å…³äºè§‚æµ‹å™ªå£°<code>v</code>æ˜¯çº¿æ€§çš„ã€‚ukfå®é™…é‡‡ç”¨å¢å¹¿çŠ¶æ€å˜é‡<code>sigmax = [x, w]</code>. è¿‡ç¨‹å™ªå£°<code>w</code>åŒ…æ‹¬å¾„å‘åŠ é€Ÿåº¦å’Œè§’åŠ é€Ÿåº¦ <code>[w_a, w_phi]</code>ï¼Œ ä¸”<code>w</code>ä¸æ˜¯æ—¶é—´çš„å‡½æ•° , å¯¹ä¸Šè¿°ç¬¬ä¸€é¡¹å¯å±•å¼€ï¼š</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=px_{k&plus;1}&space;=&space;px_k&space;&plus;&space;\int_{t_k}^{t_{k&plus;1}}&space;\dot{px}&space;dt&space;&plus;&space;\int_{0}^{\Delta&space;t}&space;w_a&space;\Delta&space;t&space;\cos{\psi}dt&space;=&space;px_k&space;&plus;&space;\frac{sin{\psi}}{\dot{\psi}}_{t_{k&plus;1}}^{t_k}&space;&plus;&space;0.5&space;w_a&space;cos{\psi}&space;\Delta&space;t^2" target="_blank"><img src="https://latex.codecogs.com/gif.latex?px_{k&plus;1}&space;=&space;px_k&space;&plus;&space;\int_{t_k}^{t_{k&plus;1}}&space;\dot{px}&space;dt&space;&plus;&space;\int_{0}^{\Delta&space;t}&space;w_a&space;\Delta&space;t&space;\cos{\psi}dt&space;=&space;px_k&space;&plus;&space;\frac{sin{\psi}}{\dot{\psi}}_{t_{k&plus;1}}^{t_k}&space;&plus;&space;0.5&space;w_a&space;cos{\psi}&space;\Delta&space;t^2" title="px_{k+1} = px_k + \int_{t_k}^{t_{k+1}} \dot{px} dt + \int_{0}^{\Delta t} w_a \Delta t \cos{\psi}dt = px_k + \frac{sin{\psi}}{\dot{\psi}}_{t_{k+1}}^{t_k} + 0.5 w_a cos{\psi} \Delta t^2"></a></p>
<h2 id="é¢„æµ‹ç©ºé—´"><a href="#é¢„æµ‹ç©ºé—´" class="headerlink" title="é¢„æµ‹ç©ºé—´"></a>é¢„æµ‹ç©ºé—´</h2><p>å¯¹æ¯”<a href="https://zjli2013.github.io/2019/03/30/å¡å°”æ›¼æ»¤æ³¢/" target="_blank" rel="external">æ‰©å±•å¡å°”æ›¼</a> ekfé‡‡ç”¨ä¸€é˜¶çº¿æ€§åŒ–è¿‘ä¼¼ã€‚æ— è¿¹å¡å°”æ›¼ukfï¼Œå°†åŸçŠ¶æ€ç©ºé—´çš„ç‰¹å¾é‡‡æ ·ç‚¹(sigmax)æ˜ å°„åˆ°é¢„æµ‹ç©ºé—´ï¼Œé‡‡ç”¨é¢„æµ‹ç©ºé—´é‡Œçš„çŠ¶æ€å˜é‡<code>f(sigmax)</code>çš„å‡å€¼ã€æ–¹å·®çš„åŠ æƒæ¨å¹¿ä½œä¸ºå…ˆéªŒçŠ¶æ€ä¼°è®¡<code>x^-</code> å’Œå…ˆéªŒè¯¯å·®<code>P^-</code>ã€‚</p>
<p>å…¶ä¸­æƒå€¼è¡¨è¿°ï¼š</p>
<pre><code>$$ w = lamda / ( lamda + ns) when i==1 $$ 
$$ w_i = 0.5/(lamba + ns)       when i!=1 $$

$$ X^- =  sum(w_i * f(sigmax) ) $$
$$ P^- =  sum(w_i * (f(sigmax) - x).^2) $$  
</code></pre><h2 id="è§‚æµ‹ç©ºé—´"><a href="#è§‚æµ‹ç©ºé—´" class="headerlink" title="è§‚æµ‹ç©ºé—´"></a>è§‚æµ‹ç©ºé—´</h2><p>å°†åŸçŠ¶æ€ç©ºé—´çš„ç‰¹å¾é‡‡æ ·ç‚¹(sigmax)æ˜ å°„åˆ°è§‚æµ‹ç©ºé—´ï¼Œé‡‡ç”¨è§‚æµ‹ç©ºé—´é‡Œçš„çŠ¶æ€å˜é‡<code>h(sigmax)</code>çš„å‡å€¼ã€æ–¹å·®çš„åŠ æƒä½œä¸ºå…ˆéªŒè§‚æµ‹å€¼<code>Z^-</code> å’Œè§‚æµ‹å€¼å…ˆéªŒè¯¯å·®<code>S^-</code>ï¼Œä½¿ç”¨ä¸é¢„æµ‹ç©ºé—´åŒæ ·çš„æƒå€¼ã€‚</p>
<pre><code>$$ Z^- =  sum(w_i * h(sigmax) ) $$
$$ S^- =  sum(w_i * (Z^- - z).^2) + R $$  
</code></pre><p>å¡å°”æ›¼æ»¤æ³¢è¡¨ç¤ºï¼š åéªŒä¼°è®¡ï¼ˆçœŸå®çŠ¶æ€å˜é‡å€¼ï¼‰ä¸å…ˆéªŒä¼°è®¡ï¼ˆé¢„æµ‹ç©ºé—´çš„çŠ¶æ€å˜é‡å€¼ï¼‰çš„å·®å¼‚ï¼Œå¯è¡¨ç¤ºä¸ºçœŸå®è§‚æµ‹å€¼ä¸è§‚æµ‹ç©ºé—´é‡Œçš„å…ˆéªŒè§‚æµ‹å€¼çš„å·®å¼‚çš„å¢ç›Š Kã€‚</p>
<pre><code>$$ x - x^-  = K (z - Z^-) $$   ï¼ˆ3ï¼‰
</code></pre><p>å¯è§ï¼Œå¡å°”æ›¼å¢ç›Š<code>K</code>åœ¨è¡¡é‡çŠ¶æ€è¯¯å·®ä¸è§‚æµ‹è¯¯å·®ä¹‹é—´çš„ç›¸å…³æ€§ã€‚å®šä¹‰é¢„æµ‹ç©ºé—´ä¸è§‚æµ‹ç©ºé—´çš„ç›¸å…³ç³»æ•°ï¼š</p>
<pre><code>T =  sum(w_i * (X^- - x)(Z^- - z))
K =  T /  S^-                   ï¼ˆ4ï¼‰
</code></pre><h2 id="ukfç®—æ³•"><a href="#ukfç®—æ³•" class="headerlink" title="ukfç®—æ³•"></a>ukfç®—æ³•</h2><p>æœ‰ï¼ˆ4ï¼‰ï¼Œ ï¼ˆ3ï¼‰ åˆ†åˆ«æ›´æ–°å¡å°”æ›¼å¢ç›Šå’ŒçŠ¶æ€å˜é‡ï¼Œ é¢„æµ‹ç©ºé—´é‡Œçš„å…ˆéªŒè¯¯å·®æ›´æ–°ç”±ï¼š</p>
<pre><code>P = P - KSK^t
</code></pre><p>ps: åœ¨éçº¿æ€§çš„å¤„ç†ä¸Šï¼Œçº¿æ€§åŒ–æˆ–è€…å¸ƒç‚¹é‡‡æ ·éƒ½æ˜¯å¸¸ç”¨çš„æ€è·¯ã€‚ä¹Ÿæ˜¯ekfä¸ukfçš„åŒºåˆ«ã€‚ </p>
<p><a href="https://starsmydestination.github.io/2017/05/09/UKF/" target="_blank" rel="external">link1</a></p>
<p><a href="https://blog.csdn.net/Young_Gy/article/details/78542754" target="_blank" rel="external">link2</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/31/CarND-term2-Extended-Kalman-Filter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/31/CarND-term2-Extended-Kalman-Filter/" itemprop="url">CarND(term2): Extended Kalman Filter</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-31T01:49:50-04:00">
                2019-03-31
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/31/CarND-term2-Extended-Kalman-Filter/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/31/CarND-term2-Extended-Kalman-Filter/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="sensor-measurement"><a href="#sensor-measurement" class="headerlink" title="sensor measurement"></a>sensor measurement</h2><h3 id="Radar"><a href="#Radar" class="headerlink" title="Radar"></a>Radar</h3><p>radio detection andranging, using radio waves to measure the distance to objects as well as their velocity and angle. Radar used a lot in preventing collions, parking assistance, cruise control. and Radar isnâ€™t affected by weather conditions. </p>
<p>while Radar canâ€™t tell an objectâ€™s shape correctly. and Radar canâ€™t detect objects if they are out of their line of sight.</p>
<p>the Radar measurement data in EKF proejcct is 3D position and velocity vector <code>(ro, theta, ro_dot)</code> in polar coordinates.</p>
<h3 id="Lidar"><a href="#Lidar" class="headerlink" title="Lidar"></a>Lidar</h3><p>light detection and ranging, using near-infrared light to scan objects and create 3D map of the enviroment. itâ€™s 360-degree view and can track movements and their directions. but it also depends on weather conditions and canâ€™t detecting the speed of other vehicles well. </p>
<p>the Lidar measurement data in EKF proeject is 2D position vector <code>(x,y)</code> in Cartesian coordinate system.  </p>
<p><a href="https://www.intellias.com/the-ultimate-sensor-battle-lidar-vs-radar/" target="_blank" rel="external">compare Radar vs Lidar</a></p>
<h2 id="server-client-network"><a href="#server-client-network" class="headerlink" title="server - client network"></a>server - client network</h2><p><a href="https://github.com/udacity/CarND-Extended-Kalman-Filter-Project" target="_blank" rel="external">Udacity simulator</a> communicate with EKF controller through websocket. </p>
<p>in simulators(Udacity carsim, Carla) running time, the message channel between simulator server and external controller need to be open all the time. so the simulator feed the controller with sensor data, and the controller feedback simulator with controlling data. </p>
<h3 id="uwebSocket"><a href="#uwebSocket" class="headerlink" title="uwebSocket"></a>uwebSocket</h3><p>built once <a href="https://zjli2013.github.io/2018/06/29/gnu-make/" target="_blank" rel="external">uwebSocket</a>, <a href="https://en.wikipedia.org/wiki/WebSocket" target="_blank" rel="external">webSocket</a> protocol providing full-duplex communication channel between server and client through a singlt TCP connection. it allows the server to send content ot the client without being first requested by the client, and allowing messages to be passed back and forth while keeping the conenction open. </p>
<h3 id="sensor-raw-data"><a href="#sensor-raw-data" class="headerlink" title="sensor raw data"></a>sensor raw data</h3><p>every data slice includes a either Lidar or Radar raw measurement and a ground truth measurement. </p>
<p>The state variable <code>x</code> is described in Cartesian coord, so for Radar measurement processing, there is a coordinate transfer from Cartesian to polar, and which lead it nonlinear, requiring Extended Karman Filter.</p>
<h3 id="EKF-controller"><a href="#EKF-controller" class="headerlink" title="EKF controller"></a>EKF controller</h3><p>the client side is the EKF controller, which process the sensor measurement.</p>
<p>define </p>
<pre><code>system state `x_` ,

  state priori covariance `P_`,

   state transition matrix `F`, 

process covariance `Q_`, 

measurement gain matrix  &apos;H&apos;

measurement covariance &apos;R_&apos; 

kalman filter gain &apos;K&apos;
</code></pre><p> as discussed in <a href="https://zjli2013.github.io/2019/03/30/å¡å°”æ›¼æ»¤æ³¢/" target="_blank" rel="external">previous blog</a>: </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> </div><div class="line"><span class="keyword">void</span> KalmanFilter::Predict()</div><div class="line">&#123;</div><div class="line">	x_ = F * x_ ;   </div><div class="line">	P_ = F * P_ * F.transpose() + Q_ ;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> KalmanFilter::Update(<span class="keyword">const</span> Vector &amp; measurement)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span>(EKF)</div><div class="line">		h = toPolar(x_); </div><div class="line">		y = measurement - h ;</div><div class="line">	<span class="keyword">else</span></div><div class="line">		y = measurement - H * x_ ;</div><div class="line">		 </div><div class="line">	K = P_ * Ht / (H * P_ * Ht + R_);  </div><div class="line">	x_ = x_ + K * y ; </div><div class="line">	P_ = (I - K*H) * P_ ;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/30/å¡å°”æ›¼æ»¤æ³¢/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/30/å¡å°”æ›¼æ»¤æ³¢/" itemprop="url">å¡å°”æ›¼æ»¤æ³¢</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-30T10:21:09-04:00">
                2019-03-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/30/å¡å°”æ›¼æ»¤æ³¢/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/30/å¡å°”æ›¼æ»¤æ³¢/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="çŠ¶æ€æ–¹ç¨‹"><a href="#çŠ¶æ€æ–¹ç¨‹" class="headerlink" title="çŠ¶æ€æ–¹ç¨‹"></a>çŠ¶æ€æ–¹ç¨‹</h2><p>çŠ¶æ€å˜é‡ <code>$x$</code> æ»¡è¶³, å…¶ä¸­ <code>u</code>ä¸ºæ§åˆ¶å˜é‡ï¼š</p>
<pre><code>$$ x = A x_prev + B u_prev + w_prev $$    (1) 
</code></pre><p>è§‚æµ‹å˜é‡ <code>$z</code> æ»¡è¶³ï¼š</p>
<pre><code>$$ z = H x + v $$                    (2)
</code></pre><p>éšæœºä¿¡å· $<code>w</code>$ å’Œ $<code>v</code>$ åˆ†åˆ«è¡¨ç¤ºè¿‡ç¨‹æ¿€åŠ±å™ªå£°å’Œè§‚æµ‹å™ªå£°ï¼Œå‡å®šç›¸äº’ç‹¬ç«‹ï¼Œä¸”æœä»æ­£æ€åˆ†å¸ƒã€‚</p>
<p>å®šä¹‰çŠ¶æ€å˜é‡çš„å…ˆéªŒä¼°è®¡ $<code>x^-</code>$ï¼Œ å³åŸºäºä¹‹å‰çŠ¶æ€å¯¹å½“å‰çŠ¶æ€çš„é¢„æµ‹å€¼ï¼› å®šä¹‰åéªŒä¼°è®¡ $<code>x^</code>$ï¼Œå³å·²çŸ¥å½“å‰è§‚æµ‹å€¼æ‰€è®¡ç®—çš„å½“å‰çŠ¶æ€å˜é‡ã€‚ å®šä¹‰å…ˆéªŒè¯¯å·® $<code>e^-</code>$, åéªŒè¯¯å·® $<code>e^</code>$, æ»¡è¶³ï¼š </p>
<pre><code>$$ e^- = x - x^- $$                     (3)

$$ e^ = x - x^ $$                         (4)
</code></pre><p>å¡å°”æ›¼æ»¤æ³¢è¡¨ç¤ºï¼š åéªŒä¼°è®¡ï¼ˆè§‚æµ‹å€¼æ‰€æ¨å¯¼çš„çŠ¶æ€å˜é‡å€¼ï¼‰ä¸å…ˆéªŒä¼°è®¡ï¼ˆé¢„æµ‹çš„çŠ¶æ€å˜é‡å€¼ï¼‰çš„å·®å¼‚ï¼Œå¯è¡¨ç¤ºä¸ºè§‚æµ‹å€¼ä¸ä»¥å…ˆéªŒä¼°è®¡ä¸ºè¾“å…¥çš„è§‚æµ‹å€¼çš„å·®å¼‚çš„å¢ç›Š <code>K</code>ã€‚</p>
<pre><code>$$ x^ -  x^- =  K ( z - H x^- ) $$     (5)
</code></pre><p><code>K</code>å¯ç”±å…ˆéªŒè¯¯å·®çš„åæ–¹å·® <code>P</code>ã€è§‚æµ‹å™ªå£°çš„åæ–¹å·®<code>R</code> å’Œè§‚æµ‹å¢ç›Š<code>H</code>è¡¨ç¤º: </p>
<pre><code>$$ K = P^- H^t /  (  HP^-H^t + R ) $$   (6)
</code></pre><p>å¯è§ï¼š</p>
<p>1ï¼‰ å½“<code>R</code> è¶‹äº0æ—¶ï¼Œ <code>k</code> è¶‹è¿‘äº <code>h</code> çš„é€†ï¼Œæ­¤æ—¶ <code>x^ = x</code>ã€‚å³å½“è§‚æµ‹è¯¯å·®å¾ˆå°ï¼Œè§‚æµ‹å€¼è¶‹è¿‘çœŸå®å€¼ã€‚</p>
<p>2ï¼‰ å½“<code>P</code>è¶‹äº0æ—¶ï¼Œå³é¢„æµ‹å€¼è¶‹è¿‘çœŸå®å€¼ã€‚  </p>
<h2 id="ç®—æ³•è®¾è®¡"><a href="#ç®—æ³•è®¾è®¡" class="headerlink" title="ç®—æ³•è®¾è®¡"></a>ç®—æ³•è®¾è®¡</h2><p>å¡å°”æ›¼æ»¤æ³¢å™¨ç”¨åé¦ˆæ§åˆ¶ä¼°è®¡è¿‡ç¨‹çŠ¶æ€ï¼ˆå˜é‡ï¼‰ï¼š  æ»¤æ³¢å™¨ä¼°è®¡æŸä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼ˆæ—¶é—´æ›´æ–°/é¢„ä¼°ï¼‰ï¼Œç„¶åä»¥ï¼ˆå«å™ªå£°çš„ï¼‰æµ‹é‡å˜é‡è·å¾—åé¦ˆï¼ˆæµ‹é‡æ›´æ–°/æ ¡æ”¿ï¼‰ã€‚</p>
<p>æ—¶é—´æ›´æ–°ï¼Œå½“å‰æ—¶æ­¥çŠ¶æ€å…ˆéªŒä¼°è®¡ <code>x^-</code> åŠå…ˆéªŒè¯¯å·®åæ–¹å·®è¿‘ä¼¼<code>P^-</code>:</p>
<pre><code>$$ x^- =  A x^-_prev + B u_prev $$  (7.1)

$$ P^- = A P^_prev A^t + Q $$         (7.2)
</code></pre><p>å…¶ä¸­ $ P(w) ~ N(0, Q) $ </p>
<p>æµ‹é‡æ›´æ–°ï¼Œä½¿ç”¨(6)æ›´æ–°å¡å°”æ›¼å¢ç›Š<code>K</code>, ä½¿ç”¨ï¼ˆ5)æ›´æ–°åéªŒçŠ¶æ€å˜é‡<code>x^</code>å’Œå½“å‰æ­¥å…ˆéªŒè¯¯å·®åæ–¹å·®å€¼ <code>P^</code>ï¼š </p>
<pre><code>$$ P = ( I  - KH ) P^-  $$            (8)
</code></pre><h2 id="æ§åˆ¶å™¨è°ƒå‚"><a href="#æ§åˆ¶å™¨è°ƒå‚" class="headerlink" title="æ§åˆ¶å™¨è°ƒå‚"></a>æ§åˆ¶å™¨è°ƒå‚</h2><p>æµ‹é‡è¯¯å·®ä¸€èˆ¬å¯è§‚æµ‹å¾—åˆ°ï¼›è€Œè¿‡ç¨‹è¯¯å·®qéœ€è¦é€šè¿‡ä¸ä¸€ä¸ªå·²çŸ¥è¯¯å·®çš„åœ¨çº¿æ»¤æ³¢å™¨å¯¹æ¯”è°ƒæ•´ç³»æ•°ã€‚è°ƒå‚ä¸€èˆ¬æ˜¯ç¦»çº¿è¿‡ç¨‹ã€‚ä¸€èˆ¬å½“è¿‡ç¨‹è¯¯å·®å’Œå¡å°”æ›¼å¢ç›Šä¼šå¿«é€Ÿæ”¶æ•›å¹¶ä¿æŒå¸¸æ•°ã€‚ä½†æµ‹é‡è¯¯å·®å—ç¯å¢ƒå½±å“ä¸æ˜“ä¿æŒä¸å˜ã€‚</p>
<h2 id="æ‰©å±•å¡å°”æ›¼"><a href="#æ‰©å±•å¡å°”æ›¼" class="headerlink" title="æ‰©å±•å¡å°”æ›¼"></a>æ‰©å±•å¡å°”æ›¼</h2><p>å½“è§‚æµ‹å€¼ä¸ç³»ç»ŸçŠ¶æ€å˜é‡ æˆ– ç³»ç»Ÿæœ¬èº«æ˜¯éçº¿æ€§å…³ç³»ï¼Œæ–¹ç¨‹(1), (2)å˜éçº¿æ€§å‡½æ•°ã€‚</p>
<pre><code>$$  x = f(x_prev, u_prev, w) $$  (1.2) 
$$  z =  h(x, v)    $$            (2.2) 
</code></pre><p><a href="https://www.cs.unc.edu/~welch/kalman/media/pdf/kalman_intro_chinese.pdf" target="_blank" rel="external">link</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/30/paper-reading-Carla-an-open-urban-driving-simulator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/30/paper-reading-Carla-an-open-urban-driving-simulator/" itemprop="url">paper reading-Carla an open urban driving simulator</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-30T03:32:25-04:00">
                2019-03-30
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/30/paper-reading-Carla-an-open-urban-driving-simulator/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/30/paper-reading-Carla-an-open-urban-driving-simulator/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://carla.org" target="_blank" rel="external">CARLA</a> used to support training, prototyping, validation of self-driving models, including perception and control. CARLA is usded to study the performance of three approaches, 1)  classic modular pipeline that comprises a vision-based perception module, a rule-based planner, and a maneuver controller; 2)a deep network that maps sensory input to driving commands via imitaion learning;  3) end-to-end reinforcment learning.</p>
<p>all approaches make use of a high-level topological planner. the planner takes the current position of the agent and the location of the goal as input, and use A* algorithm to provide a high-level plan.  this plan advises the agent to turn left/right, or keep straight at intersections, but not provide a trajectory neither geometric info. which is a weaker form of common GPS.</p>
<h2 id="simulation-engine"><a href="#simulation-engine" class="headerlink" title="simulation engine"></a>simulation engine</h2><p>CARLA simulates a dynamic world and provide a simple interface between the world and an agent that interacts with the world. CARLA is designed as a server-client system, where the server runs the simulation and renders the scene, the client API is responsible for interaction between the agent and the server via sockets.</p>
<p>the client send commands and meta-commands to the server and receives sensor readings in return. the comands control the vehicle and includes steering, accelerating, and braking. meta-commands controls the behavior of hte server, e.g. resetting hte simulation, modifying the sensor suite.</p>
<h3 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h3><p>the static 3D world, such as buildings, traffic signs,  and the dynamic objects such as vehicles, pedestrains. the behavior of non-player characters is based on standard UE4 vehicle model(PhysXVehicles), and extended with a basic controller to govern NPCâ€™s behavior: lane following, respecting traffic lights, speed limits, and decision making at intersections.</p>
<h3 id="pedestrains"><a href="#pedestrains" class="headerlink" title="pedestrains"></a>pedestrains</h3><p>pedestrains navigate the streets according to a town-specific navigation map, which conveys a location-based cost, which is designed to encourage pedestrains to walk along sidewalkd and marked road crossing, but allows them to cross road at any point.</p>
<h3 id="sensors"><a href="#sensors" class="headerlink" title="sensors"></a>sensors</h3><p>camera parameters include 3D location, 3D orientation with respect to the vehicleâ€™s coordinate system, field of view, and depth of field.</p>
<p>the semantic segmentation pseudo-sensor provides 12 semantic classes:  road, land-marking, traffic sign, sidewalk, fence, pole, wall, building, vegetation, vehicle, pedestrain, and other.</p>
<p>a range of measurements associated with the state of the agent.  ? </p>
<p>measurements concerning traffic rules include the percentage of vehicleâ€™s footprint that impinges on wrong-way lanes or sidewalks, as well as states of the traffic lights and speed limit at the current location of the vehicle. </p>
<p>CARLA provides access to exact location and bounding boxes of all dynamic objects. </p>
<h2 id="autonomous-driving"><a href="#autonomous-driving" class="headerlink" title="autonomous driving"></a>autonomous driving</h2><p>the agent interacts with the environment over discrete time steps. at each time step, the agent gets an observation, which is a tuple of sensory inputs, and must produce an action, which represents steering, throttle, brake. </p>
<h3 id="modular-pipeline"><a href="#modular-pipeline" class="headerlink" title="modular pipeline"></a>modular pipeline</h3><p>the pipeline includes:  perception, planning, continuous control. local planning is critical based on visual perception.</p>
<h4 id="perception"><a href="#perception" class="headerlink" title="perception"></a>perception</h4><p>using semantic segmentation network based on RefineNet to estimate lanes, road limits, and dynamic objects. and a classification model is used to determine proximity to intersections. </p>
<h4 id="the-local-planner"><a href="#the-local-planner" class="headerlink" title="the local planner"></a>the local planner</h4><p>coordinates low-level navigation by generating a set of waypoints, near-term goal states that represents the desired position and orientation of the car in near future.  the rule-based state:  1) road-following,  2) left-turn, 3) right-turn, 4) intersection-forward, 5) hazard-stop. transitions between states are performed based on estimates provided by the perception module and on topological info provided by the global planner.</p>
<h4 id="continuous-controller"><a href="#continuous-controller" class="headerlink" title="continuous controller"></a>continuous controller</h4><p>using PID controller, which inputs current pose, speed, a list of waypoints, and outputs steering, throttle, and brake.</p>
<h2 id="carla-release"><a href="#carla-release" class="headerlink" title="carla release"></a>carla release</h2><h3 id="9-1"><a href="#9-1" class="headerlink" title="9.1"></a>9.1</h3><p>1)   enable client to detect collisions and determine lane changes :  <code>sensor.other.collision</code>, <code>sensor.other.lane_detector</code>, </p>
<p>2)  access to the road network, waypoints nearby current vehicle and define user navigation algorithms: <code>Map</code></p>
<p>3) support new map created from external RoadRunner/VectorZero, in OpenDriven map standard </p>
<h3 id="9-2"><a href="#9-2" class="headerlink" title="9.2"></a>9.2</h3><p>1) simulation of traffic scenarios by <a href="https://github.com/carla-simulator/scenario_runner" target="_blank" rel="external"><code>Scenario Runner</code></a>. e.g.  following leading vehicle,  stationary object crossing, dynamic object crossing, opposite vehicle running red light, vehicle turn right/left etc</p>
<p>2)upgraded ROS bridge </p>
<p>3) vehicle navigation from client side: <code>BasicAgent</code>, navigate to a point given location while dealing with other vehicles and traffic lights safely;  <code>RoamingAgent</code>, drives around making random choices when presented to multiple options</p>
<h3 id="9-3"><a href="#9-3" class="headerlink" title="9.3"></a>9.3</h3><p>1) new town and new pedestrains </p>
<p>2) no rendering mode, a 2D map visualization tool that display vehicles, traffic lights, speed limits, pedestrains, road, etc. help to improve the server framerate</p>
<p>3) traffic light class in client <code>TrafficLightState</code> </p>
<p>4) new sensors.  <code>ObstacleDetector</code>, a simple raycast sensor to detect something in front of the ego vehicle and what is it; and <code>GlobalNavigationSatelliteSystem</code>, attach to ego vehicle and get its geolocation, which is based on the geo-reference define in OpenDriven file associated with each map.</p>
<h3 id="9-4"><a href="#9-4" class="headerlink" title="9.4"></a>9.4</h3><p>1) allow client side to change physics properties of vehicle or their components in runtime <code>WheelsPhysicsControl</code> </p>
<p>2) logging and playback system, which includes a camera-following mode to follow a target actor while replaying the simulation, and can replay situations from different viewpoints. and the logging query engine allow users to query different types of events.</p>
<p>3) random streaming port, which makes it possible to stream sensor data in a secondary port</p>
<p>4) import maps,  replace maps as tar.gz files in â€œExportedMapsâ€ folder </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/paper-reading-autonoVi-AV-planning-with-dynamic-maneuvers-and-traffic-constraints/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/paper-reading-autonoVi-AV-planning-with-dynamic-maneuvers-and-traffic-constraints/" itemprop="url">paper reading-autonoVi: AV planning with dynamic maneuvers and traffic constraints</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-29T10:21:35-04:00">
                2019-03-29
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/29/paper-reading-autonoVi-AV-planning-with-dynamic-maneuvers-and-traffic-constraints/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/29/paper-reading-autonoVi-AV-planning-with-dynamic-maneuvers-and-traffic-constraints/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>this is the advanced driver module in <a href="https://zjli2013.github.io/2019/03/28/paper-reading-autono-Vi-Sim-simualtion-platform/" target="_blank" rel="external">Vi-sim simulation platform</a>. this driver module algorithm pipeline:  </p>
<p>1) a route plan by graph-search over the network of roads </p>
<p>2) rules based guiding trajectories generation(traffic and lane following rules) </p>
<p>3) set of candidate trajectories(control inputs) generation and evaluated by vehicle dynamic model and collision free model</p>
<p>4) most feasible trajectory evaluated through optimization</p>
<h3 id="vehicle-state-space"><a href="#vehicle-state-space" class="headerlink" title="vehicle state space"></a>vehicle state space</h3><p>the full state of a vehicle updates: </p>
<p><code>X = (x, y, v, theta, throttle, steering, behavior)</code></p>
<p>the vehicle updates its plan at a fixed palnning rate <code>dt</code>; at each pllaning step, the vehicle computes a target speed <code>v</code> and target steering <code>theta</code> to be achieved by the control system </p>
<p><code>S(u, X)</code> determine if a set of control is feasible, given current state of the vehicle, <code>S(u, X)</code> will return false if the given input <code>u</code> cause a loss of traction or control.</p>
<h3 id="sensing-and-perception"><a href="#sensing-and-perception" class="headerlink" title="sensing and perception"></a>sensing and perception</h3><p>the sensing module provide an approximation of the center line of lane, closet point on the lane center to the ego-vehicle, and friction coefficient.</p>
<h3 id="route-choice-and-behavior-state"><a href="#route-choice-and-behavior-state" class="headerlink" title="route choice and behavior state"></a>route choice and behavior state</h3><p>behavior set includes merging, right turn, left run, keep straight. the behavior state of the vehicle is described as a finite-state machine(turn left, turn right, merge left, merge right), which restrict potential control decisions and adjust the weight of the cost function. </p>
<h3 id="guiding-path"><a href="#guiding-path" class="headerlink" title="guiding path"></a>guiding path</h3><p>the ego-vehicle computes a set of waypoints along the current lane at fixed time intervals. <code>how to create the path based on waypoints</code> </p>
<h3 id="collision-avoidance"><a href="#collision-avoidance" class="headerlink" title="collision avoidance"></a>collision avoidance</h3><p>define obstacles domain for each neighbor of the ego-vehicle, which is defined as all controls that could lead to collision.  the obstacles domain and the set of dynamic infeasible domain form the boundary of collision-free space for the ego-vehicle. </p>
<h3 id="trajectory-sampling"><a href="#trajectory-sampling" class="headerlink" title="trajectory sampling"></a>trajectory sampling</h3><p>the exact obstacle domain is not computing time efficent, instead here use a sampling strategy around <code>theta</code> and <code>v</code> to determin a feasible control. each sample is referred to as a candidata control <code>u_c</code>.</p>
<h3 id="trajectory-cost-function"><a href="#trajectory-cost-function" class="headerlink" title="trajectory cost function"></a>trajectory cost function</h3><p>once the set of suitable control candidates has been computed, the most feasible control will be selected by minimizing the cost function for each sample point <code>i</code> : </p>
<p><code>C = sum_i{ C_path(i) + C_cmft(i) + C_mnvr(i) + C_prox(i)</code> </p>
<p>1) path cost, defined as success at tracking its path and the global route.</p>
<p>2) comfort cost, <code>C_cmfg = ||vel_acc|| +  ||theta_acc||</code> </p>
<p>3) maneuver cost, penalize lane changes <code>C_mnvr = lane_change</code> </p>
<p>4)  proximity cost, prevent the ego vehicle from passing close to neighbors. </p>
<h3 id="control-input"><a href="#control-input" class="headerlink" title="control input"></a>control input</h3><p>one PID controller to driven current speed to match the target speed;  another PID controller drives the current steering angle to match the target.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/æœªæ¥5å¹´åœ¨å“ªé‡Œ-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/æœªæ¥5å¹´åœ¨å“ªé‡Œ-6/" itemprop="url">æœªæ¥5å¹´åœ¨å“ªé‡Œ(6)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-29T10:18:02-04:00">
                2019-03-29
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/29/æœªæ¥5å¹´åœ¨å“ªé‡Œ-6/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/29/æœªæ¥5å¹´åœ¨å“ªé‡Œ-6/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å¹¿å·ä¹‹è¡Œ"><a href="#å¹¿å·ä¹‹è¡Œ" class="headerlink" title="å¹¿å·ä¹‹è¡Œ"></a>å¹¿å·ä¹‹è¡Œ</h2><p>æŠ•è‡ªåŠ¨é©¾é©¶ï¼Œéšçº¦æœ‰äº›ä¸å®‰å…¨æ„Ÿã€‚æ¯”å¦‚ï¼Œæ¿€å…‰é›·è¾¾ã€å®šä½l3+çš„HDMap, ä»¿çœŸç¯å¢ƒï¼Œl4å…¨æ ˆè§£å†³æ–¹æ¡ˆã€‚ä¸€æ—¦l3+ä»¥ä¸Šçš„è‡ªåŠ¨é©¾é©¶æ–¹æ¡ˆçŸ­æœŸå†…ä¸ä¼šé‡äº§ï¼Œåšè¿™äº›æ–¹å‘çš„åˆ›ä¸šå›¢é˜Ÿã€äº§å“æŠ•å…¥éƒ½ä¼šâ€æ­»â€œã€‚</p>
<p>å›½å†…æ‰€æœ‰è¡Œä¸šçš„æ¿€çƒˆç«äº‰ï¼Œé€ æˆåŒ…æ‹¬äº’è”ç½‘å…¬å¸ã€ä¸»æœºå‚ã€åˆ›ä¸šå›¢é˜Ÿï¼Œéƒ½å¼ºçƒˆéœ€è¦è½åœ°äº§å“ã€‚è€Œå¯¹äºä¸€ä¸ªé¥é¥æ— æœŸï¼Œ5ï½10å¹´ï¼Œç”šè‡³æ›´ä¹…ä»¥åæ‰èƒ½å®ç°çš„äº§å“çš„æŠ€æœ¯ç ”å‘æŠ•å…¥æ˜¯æ‰€æœ‰å…¬å¸ä¸èƒ½æ‰¿å—ä¹‹è½»ã€‚ç›¸åï¼Œå¯¹èƒ½å¿«é€Ÿè½åœ°çš„äº§å“ã€åº”ç”¨åœºæ™¯ï¼Œä¹Ÿæ˜¯å„æ–¹å‘åŠ›çš„åœ°æ–¹ã€‚æ¯”å¦‚ï¼Œ l1 ~ l2.5 çš„ adas äº§å“ã€‚</p>
<p>åœ¨å›½å¤–ä¸»æœºå‚ä¾§é‡ç ”å‘ï¼›å›½å†…ä¸»æœºå‚ä¾§é‡è½åœ°ã€‚ä¹Ÿæ˜¯å›å›½æ„Ÿå—åˆ°çš„è½å·®ã€‚æœ‹å‹è®²ï¼Œå›½å†…ä¸»æœºå‚å¯¹ä¾›åº”å•†çš„ä¾èµ–å¾ˆé‡ã€‚é•¿åŸçš„æƒ…å†µå¤§æ¦‚å°±æ˜¯ï¼Œl3ä»¥ä¸‹çš„adasäº§å“è½¯ç¡¬ä»¶å…¨æ ˆç”±ä¾›åº”å•†æä¾›ï¼Œä¸»æœºå‚è‡ªèº«è¿æ ‡å®š/è°ƒå‚éƒ½ä¸å‚ä¸ğŸ˜“ã€‚ä¸»æœºå‚çš„è¶‹åŠ¿æ˜¯æ…¢æ…¢è‡ªå·±åšï¼Œä¹Ÿæ˜¯å›½å†…æ±½è½¦äººçš„æœºä¼šå§ã€‚ç›¸æ¯”ï¼Œç¦ç‰¹ï¼Œé€šç”¨éƒ½æ˜¯15+ä¸‡å‘˜å·¥çš„è§„æ¨¡ï¼Œå›½å†…è‡ªä¸»å“ç‰Œä¸»æœºå‚çš„å‘˜å·¥è§„æ¨¡åœ¨1/20ã€‚å¦å¤–ï¼Œå›½å†…ä¸»æœºå‚å‘˜å·¥å¤§å¤šæ˜¯dreè§’è‰²ã€‚</p>
<p>è¡Œä¸šèµ°è¿‘äº†ï¼Œéƒ½æ˜¯æ·±æ°´ã€‚æƒ³è½»è½»æ¾æ¾å·¥ä½œï¼Œå°±æ˜¯è¡¨é¢åˆ’æ°´ã€‚å¯¹è¡Œä¸šé£é™©ç¼ºä¹åˆ¤æ–­ã€æˆ–è€…ä¸èƒ½æ‰¿å—è¡Œä¸šé£é™©çš„ï¼Œæƒ³æŒ‘å®¹æ˜“çš„æ´»å„¿ï¼Œé‚£åœ¨å“ªè¡Œéƒ½å¾…ä¸é•¿ã€‚æ‰€ä»¥å•Šï¼Œå¹´è½»äººå°±è¦åœ¨å‹åŠ›ç¯å¢ƒä¸‹æ´»ç€ã€‚</p>
<h2 id="æ±½è½¦åˆ›ä¸š"><a href="#æ±½è½¦åˆ›ä¸š" class="headerlink" title="æ±½è½¦åˆ›ä¸š"></a>æ±½è½¦åˆ›ä¸š</h2><p>äº†è§£åˆ°ä¸€äº›æ±½è½¦è¡Œä¸šçš„åˆ›ä¸šè€…ï¼Œæ¯”å¦‚åšæ±½è½¦äº‘ã€è½¦è½½æœåŠ¡ã€ä»¥åŠè‡ªåŠ¨é©¾é©¶è½¯ç¡¬ä»¶æ–¹æ¡ˆã€‚å¯èƒ½å› ä¸ºåˆ›ä¸šæ–¹å‘æœ¬èº«åªæ˜¯ä¾æ‰˜äºè‡ªé©¾ã€æ™ºèƒ½ç½‘è”è½¦ç­‰å…·ä½“åº”ç”¨åœºæ™¯ï¼Œå…¶æ‰€åˆ›çš„æŠ€æœ¯åªæ˜¯ä¸€äº›åœ¨å…¶ä»–é¢†åŸŸæˆç†Ÿæˆ–æ–°çš„æŠ€æœ¯ã€‚æ¯”å¦‚ï¼Œäº‘è®¡ç®—ã€ç§»åŠ¨æ“ä½œç³»ç»Ÿã€è§†è§‰AIã€5Gç­‰æŠ€æœ¯åœ¨æ±½è½¦è½½ä½“ä¸Šçš„è½¬åŒ–åº”ç”¨ã€‚</p>
<p>æ‰€çœ‹åˆ°çš„æ±½è½¦é¢†åŸŸçš„åˆ›ä¸šï¼Œæ›´åƒæ˜¯ä¸€ä¸ªæŠ€æœ¯è½¬åŒ–ã€‚è€Œæºäºæ±½è½¦é¢†åŸŸè‡ªèº«çš„æ–°åˆ›æ„ï¼Œä¼¼ä¹åªåœ¨åšä¸–ã€å¤§é™†ç­‰æˆç†ŸæŠ€æœ¯ç§¯æ·€çš„ä¼ä¸šé‡Œé¢é€æ­¥æ¨è¿›çš„ã€‚è€Œä¸”è¡Œä¸šå†…æ–°åº”ç”¨åœºæ™¯çš„æ ‡å‡†å®šä¹‰ä¹Ÿæ˜¯ç”±è¿™äº›å¤§å‚ä¸»å¯¼çš„ã€‚æ¯”å¦‚ï¼ŒAutoSar, LTE-V2X, ADASå‰è£…éœ€æ±‚å®šä¹‰ç­‰ç­‰ã€‚</p>
<p>æ²¡æœ‰è¡Œä¸šç§¯æ·€çš„æ±½è½¦åˆ›ä¸šï¼Œçœ‹ç€å«å¿ƒæ‚¬ï¼Œè¿™æ ·éƒ½æ•¢ç©ï¼ä»–ä»¬æœ€å¥½çš„å‘½è¿å¯èƒ½æ˜¯è¢«ä¸»æœºå‚æ”¶è´­ï¼Œä½†æ˜¯æ›´å¤§å¯èƒ½æ˜¯è¢«äº’è”ç½‘å·¨å¤´æŒ¤æ‰ï¼Œæ— å£°æ— æ¯ã€‚ä»å¹¿å·å›å®¶çš„è·¯ä¸Šæƒ³åˆ°ï¼šè‡ªå·±æ›¾ç»ä¹Ÿæ˜¯æœ‰æ¢¦æƒ³çš„äººï¼Œé¢å¯¹ç°åœ¨çš„å¸‚åœºç¯å¢ƒï¼Œä¹Ÿè®¸èƒ½å»ä¸ªå¤§å¹³å°åšç‚¹äº‹ï¼Œå°±èŠä»¥è‡ªæ…°äº†ã€‚</p>
<p><code>åˆ›ä¸š</code> æœ¬æ˜¯ä¸ªæŒºå¥½çš„äº‹å„¿ï¼Œä½†å¿…é¡»æœ‰å¼ºå¤§çš„ä¿¡å¿µï¼Œè§‰å¾—è¿™äº‹å„¿ä¸€å®šèƒ½æˆã€‚åªæƒ³æä¸ªæ¦‚å¿µç§»æ¤ï¼Œé‚£æ˜¯æ³¨å®šè¦å‡‰ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/28/paper-reading-autono-Vi-Sim-simualtion-platform/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/28/paper-reading-autono-Vi-Sim-simualtion-platform/" itemprop="url">paper reading- autono Vi-Sim simualtion platform</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-28T05:36:00-04:00">
                2019-03-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/28/paper-reading-autono-Vi-Sim-simualtion-platform/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/28/paper-reading-autono-Vi-Sim-simualtion-platform/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="introduction-of-Vi-Sim"><a href="#introduction-of-Vi-Sim" class="headerlink" title="introduction of Vi-Sim"></a>introduction of Vi-Sim</h2><ul>
<li><p>data generation, allowing exports of traffic data and virtual sensor data on the vehicle, which can be used in training DL by generating automatically labelled classification and control data</p>
</li>
<li><p>dynamic traffic conditions, with varying vehicles, pedestrians, lighting, weather </p>
</li>
<li><p>rapid scenario construction</p>
</li>
</ul>
<h2 id="simulation-modules"><a href="#simulation-modules" class="headerlink" title="simulation modules"></a>simulation modules</h2><p> Vi-Sim is divided into 8 extensible modules. </p>
<h3 id="roads"><a href="#roads" class="headerlink" title="roads"></a>roads</h3><p> represented by center line, #lanes, directions, surface friction. the roads can quick constructed by drawing splines on the landscape</p>
<h3 id="road-network"><a href="#road-network" class="headerlink" title="road network"></a>road network</h3><p> provides connectivity information of road and traffic infrastructure. the road network provides routing and localization purpose.</p>
<h3 id="infrastructure"><a href="#infrastructure" class="headerlink" title="infrastructure"></a>infrastructure</h3><p> represents traffic lights, signage, and any entities that will modify the behavior of vehicles on the road. </p>
<h3 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h3><p> represents the time of the day, weather, rain conditions, road friction etc. </p>
<h3 id="non-vehicle-traffic"><a href="#non-vehicle-traffic" class="headerlink" title="non-vehicle traffic"></a>non-vehicle traffic</h3><p> basically pedestrains and cyclists in the map. both are following safe traffic rules.</p>
<h3 id="data-capture"><a href="#data-capture" class="headerlink" title="data capture"></a>data capture</h3><p> this module used for logging data of the environment as well as sensor data from ego vehicle</p>
<h2 id="driving-modules"><a href="#driving-modules" class="headerlink" title="driving modules"></a>driving modules</h2><h3 id="vehicle"><a href="#vehicle" class="headerlink" title="vehicle"></a>vehicle</h3><p>  represented as a physical-driven entity with specific tire, steering, sensor parameters. </p>
<p>  the vehicle has 3 components: </p>
<pre><code>* control is provided with steering, throttle, brake inputs;  


* dynamics is implemented in Nvidia physX engine; 


* perception component is a ray-cast with configurable uncertainty, detection time, classification error rate, and sensor angle/range. 
</code></pre><p>   a vehicle can equip multiple sensors. the perception component provides interface to a generic camera interface and Monte Carlo scanning ray-casts, which can be extended to Lidar/camera based NN claassifiers. </p>
<h3 id="driver"><a href="#driver" class="headerlink" title="driver"></a>driver</h3><p>   driving decision module, who fuses information from road network and vehicleâ€™s sensor to make decisions. currently there are 3 driver models</p>
<pre><code>   * lane-following driver, which employs control command like lane-keeping ADAS

   * manual driver, allows a human drive the vehicle

* autonoVi driver, use optimization-based maneuvering with traffic constraints to generate advanced behaviors 
</code></pre><h2 id="limitations"><a href="#limitations" class="headerlink" title="limitations"></a>limitations</h2><ul>
<li><p>lack of calibaration configuration to replicate specific sensors</p>
</li>
<li><p>driver modules are limited to hierarchical, rule-based approaches</p>
</li>
<li><p>real traffic conditions </p>
</li>
</ul>
<h2 id="thoughts"><a href="#thoughts" class="headerlink" title="thoughts"></a>thoughts</h2><pre><code>1) sensor components in simulation, e.g.  Lidar, camera, Radar

2) sensor calibration in simulation, Apollo and Carla may has some good suggestions 

3) multi-agents environment

4) distributed framework to ensure real time multi-agents simualtion 
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/28/paper-reading-distributed-simulation-platform-for-autonomous-driving/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/28/paper-reading-distributed-simulation-platform-for-autonomous-driving/" itemprop="url">paper reading-distributed simulation platform for autonomous driving</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-28T01:21:13-04:00">
                2019-03-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/28/paper-reading-distributed-simulation-platform-for-autonomous-driving/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/28/paper-reading-distributed-simulation-platform-for-autonomous-driving/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>to test newly developed algorithms, due to the massive amount of simulation data, need a distributed simulation platform based on Spark distributed framework.</p>
<ul>
<li><p>simulation based on synthetic data, used in control and planning </p>
</li>
<li><p>simulation based on real data playback, used to test function and performance of different components</p>
</li>
</ul>
<p>in autonomous driving system, each functional module in ROS is deployed as a node, the communication between nodes rely on the messages with well-defined formats. so the test of each module is independent, we can develop simulation module for each functional module. </p>
<h2 id="anatomy-of-simulator"><a href="#anatomy-of-simulator" class="headerlink" title="anatomy of simulator"></a>anatomy of simulator</h2><p>there should be a dynamic model of the car, a vehicle dynamic model;  then the external environment is needed, which includes static and dynamic scenes.</p>
<p>the simulator can decompose external environment into basic elements, and rearranges the combination to generate a variety of test cases, each simulating a specific scenario. </p>
<p>e.g. the position, speed, next step command of the barrier vehicle can give different basic elements. </p>
<h2 id="ROS-based-simulator"><a href="#ROS-based-simulator" class="headerlink" title="ROS based simulator"></a>ROS based simulator</h2><p>to use the real traffic data to reproduce the real scene requires a distributed simulation platform. </p>
<ul>
<li><p>ROSBAG, record from Topic and replay message to Topic. </p>
<p>  the Record function is to create a recording node in ROS, and call the subscribe method to receive ROS message to all Topics, and then write the message to Bag file. </p>
<p>  the Play function is to establish a play node, and call the advertise method to send message in bag to specified Topic. </p>
</li>
</ul>
<h2 id="Spark-distributed-platform"><a href="#Spark-distributed-platform" class="headerlink" title="Spark distributed platform"></a>Spark distributed platform</h2><p>the Spark driver launch different simulation applications, e.g. localization algorithms, object recoginization algorithms, vehicle decision-making and control algorithms etc, then allocate resources to each Spark worker, who first reads the RosBag data into memory and launches a ROS node to process the incoming data. </p>
<p>the interface between Spark and ROS is through Linux pipe, basically data written to the write end of the pipe is buffered by the kernel until it is read from the read end of the pipe.</p>
<p>two problems: 1) Spark only support text-based data consuming; 2) Spark memeory to ROBag </p>
<h3 id="Binary-data-streaming"><a href="#Binary-data-streaming" class="headerlink" title="Binary data streaming"></a>Binary data streaming</h3><p>the core Spark data structure is resilient distributed dataset (RDD). to process and transform binary data into a user-defined format and transform the output of Spark computation into a byte stream, even further to a generic binary file(HDFs)</p>
<pre><code>1) encode and serialize the binary files(image, lidar input data) to form a binary byte stream 

2) de-serialize and decode the binary stream, according to interpret byte stream into an understandable format and perform target computation

3) the output then be encoded and serialized before passed in RDD partitions(e.g. HDFs), and returned to Spark driver 
</code></pre><h3 id="data-retrieval-through-ROSbag-cache"><a href="#data-retrieval-through-ROSbag-cache" class="headerlink" title="data retrieval through ROSbag cache"></a>data retrieval through ROSbag cache</h3><p>two things: reading from memory through ROSbag play, and writing to memory through ROSbag record. </p>
<p>solution: design a memoryChunkedFile class, derived from ChuckedFile class, to read/write memory rather than files.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/paper-reading-perception-planning-control-and-coordination-for-autonomous-vehicles/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/paper-reading-perception-planning-control-and-coordination-for-autonomous-vehicles/" itemprop="url">paper reading-perception, planning, control and coordination for autonomous vehicles</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-27T05:41:05-04:00">
                2019-03-27
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/27/paper-reading-perception-planning-control-and-coordination-for-autonomous-vehicles/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/27/paper-reading-perception-planning-control-and-coordination-for-autonomous-vehicles/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Lidar-Perception"><a href="#Lidar-Perception" class="headerlink" title="Lidar Perception"></a>Lidar Perception</h2><ul>
<li><p>point cloud based approach, directly use the raw sensor data for further processing. usually applied a voxel-based filtering to reduce the number of points </p>
</li>
<li><p>feature based approach, extract parametric features out of the point cloud, and represent the environment usign extracted features (out of date)</p>
</li>
<li><p>grid based approach</p>
</li>
</ul>
<h3 id="segmentation-algorithms"><a href="#segmentation-algorithms" class="headerlink" title="segmentation algorithms"></a>segmentation algorithms</h3><p>cluster points into multiple homogeneous groups.</p>
<ul>
<li>edge based method</li>
<li>region based method, cluster neighborhood points based on certain criteria</li>
<li>model-based / parametric method,</li>
<li>graph based method </li>
</ul>
<h3 id="detection-algorithms"><a href="#detection-algorithms" class="headerlink" title="detection algorithms"></a>detection algorithms</h3><p>categorize each cluster into different objects, the information in each cluster is mainly from spatial relationship and Lidar intensity of the points. </p>
<h2 id="Vision"><a href="#Vision" class="headerlink" title="Vision"></a>Vision</h2><p>usually deal with road detection and on-road object detection. </p>
<h2 id="Road-Detection"><a href="#Road-Detection" class="headerlink" title="Road Detection"></a>Road Detection</h2><h3 id="lane-mark-detection"><a href="#lane-mark-detection" class="headerlink" title="lane mark detection"></a>lane mark detection</h3><ul>
<li><p>lane line feature extraction<br>basically identify the pixels that belong to lane line marks. </p>
</li>
<li><p>fitting the pixels into different models</p>
</li>
</ul>
<ul>
<li>estimate the vehicle pose(lateral position and moving orientation) based on the fitted model. </li>
</ul>
<h3 id="road-surface-detection"><a href="#road-surface-detection" class="headerlink" title="road surface detection"></a>road surface detection</h3><p>inform the self-driving car on the location of free space where it can drive without collision. usually three ways:</p>
<ul>
<li>feature based detection</li>
</ul>
<p>first identify the feature points or patches in the original image; based on the identified features, either model fitting or segmentation kind of algorithms will be applied to identify the road surfaces. </p>
<ul>
<li>feature based learning<br>first extract a set of features associated to pixels or image patches, then train a classifier based on the features to assign a road or non-road label to the pixels or patches</li>
</ul>
<ul>
<li>deep learning</li>
</ul>
<h3 id="on-road-object-detection"><a href="#on-road-object-detection" class="headerlink" title="on-road object detection"></a>on-road object detection</h3><p>mainly concerns vehicle and pedestrain object classes, and mainly with deep learning based approaches, whose pipeline usually like:</p>
<p>1) the proposal bounding boxes needs to be generated around the input image</p>
<p>2) each proposal box will be sent through the CNN network to determine a classification and fine tune its bounding box location </p>
<h2 id="Fusion"><a href="#Fusion" class="headerlink" title="Fusion"></a>Fusion</h2><p>sensor fusion betweeen Lidar and camera is necessary to make the best use of these devices and achive a robust environment perception result. </p>
<h2 id="Localization"><a href="#Localization" class="headerlink" title="Localization"></a>Localization</h2><p>the problem of estimating the ego vehicleâ€™s pose, can divided into 2 sub-problems:  pose fixing problem and dead reckoning problem. </p>
<ul>
<li><p>pose fixing problem is to predict a measurement given a pose, e.g. a map. </p>
</li>
<li><p>dead reckoning problem, the state is related to the observation by a set of differential equations, and these equations has to be integrated in order to navigate. </p>
</li>
</ul>
<p>map aided localization algorithm use local features to achieve highly precise localization.  e.g. SLAM.</p>
<p>a key event in smoothing based SLAM is loop closure, basically when features that have not been seen for a while are observed again from the sensor readings. when a loop closure is detected, the error caused by imperfect odometry can then be removed, and a substantial portion of the map can be updated. </p>
<p>approaches to semantic mapping can be categorized into three ways:  object based, appearance based, and activity based. </p>
<ul>
<li><p>appearance based semantic mapping, interpret sensor readings to construct semantic information of the environment</p>
</li>
<li><p>object based semantic mapping, use the occurrence of key objects to build a semantic understanding of the environments, where object recognition and classification is important. </p>
</li>
<li><p>activity based semantic mapping, relies on information about the activities of the agents around the ego vehicle. </p>
</li>
</ul>
<h2 id="Planning"><a href="#Planning" class="headerlink" title="Planning"></a>Planning</h2><h3 id="mission-planning"><a href="#mission-planning" class="headerlink" title="mission planning"></a>mission planning</h3><p>performed through graph search over a directed graph network, which reflects road/path network connectivity. </p>
<h3 id="behavioral-planning"><a href="#behavioral-planning" class="headerlink" title="behavioral planning"></a>behavioral planning</h3><p>decision making to ensure the vehicle follows any road rules and interacts with other agents in a conventional, safe manner. </p>
<h3 id="motion-planning"><a href="#motion-planning" class="headerlink" title="motion planning"></a>motion planning</h3><p>the process of deciding on a sequence of actions to reach a specified goal, typically based on avoiding colisions on a sequence of actions to reach a specified goal. </p>
<ul>
<li>combinatorial planning, builds a discrete representation of the real environment, and finds a complete solution. </li>
</ul>
<ul>
<li>sampling-based planning, utilizes a collision checking module to conduct discrete searching over samples drawn from the configuration space, which rely on random sampling of continuous spaces and the generation of  a feasible trajectory graph where feasibility is verified through collision checking of nodes and edges to connect these nodes .</li>
</ul>
<h3 id="planning-in-dynamic-environments"><a href="#planning-in-dynamic-environments" class="headerlink" title="planning in dynamic environments"></a>planning in dynamic environments</h3><ul>
<li><p>decision making structures for obstacle avoidance </p>
<p>  to monitor regions along the intended path for potential obstacle collisions, where these regions are labeled as â€œcritial zonesâ€, and checking against the trajectories of all nearby vehicles to determine a â€œtime to collisionâ€. </p>
</li>
</ul>
<ul>
<li>planning in space-time </li>
</ul>
<ul>
<li><p>control space obstacle represnetations </p>
<p>  rather than checking for collisions directly in robotâ€™s configuration space, directly plan in the control space by prohibiting certain control actions which are predicted to lead to collision.</p>
</li>
</ul>
<h3 id="incremental-planning-and-replanning"><a href="#incremental-planning-and-replanning" class="headerlink" title="incremental planning and replanning"></a>incremental planning and replanning</h3><p>a means of incrementally generating sub-goals, a new plan is generated as often as a new sub-goal is defined. iteratively replanning to generate new solution trajectories presents a potential opportunity to carry over knowledge from previous planning iterations to subsequent planning iterations.</p>
<h2 id="Control"><a href="#Control" class="headerlink" title="Control"></a>Control</h2><h3 id="feedback-control"><a href="#feedback-control" class="headerlink" title="feedback control"></a>feedback control</h3><p>e.g. proportional-integral-derivative(PID) controller, the limitation of feedback-only control, is has delayed response to errors.</p>
<h3 id="model-predictive-control"><a href="#model-predictive-control" class="headerlink" title="model predictive control"></a>model predictive control</h3><h3 id="trajectory-generation"><a href="#trajectory-generation" class="headerlink" title="trajectory generation"></a>trajectory generation</h3><ul>
<li><p>combined trajectory generation and tracking </p>
</li>
<li><p>separate trajectory generation and tracking </p>
<p>  1) trajectory generation, to find an entire control input, which corresponds to some desired state trajectory. can be dealed as a two point boundary value problem, with a starting state and a final state. </p>
<p>  1.1) sensor based trajectory generation</p>
<p>  1.2) dynamic based trajectory generation </p>
</li>
</ul>
<h3 id="trajectory-tracking"><a href="#trajectory-tracking" class="headerlink" title="trajectory tracking"></a>trajectory tracking</h3><ul>
<li><p>geometric methods</p>
<p>  pursues a point along the path that is located at a certain lookahead distance away from the vehicleâ€™s current position. the input is waypoints, rather than smooth curves. </p>
</li>
<li><p>model based methods </p>
<p>  kinematic model based controllers performs well at low speed applications, but the error increase as the vehicle speed and curvature rate of path increases.</p>
<p>  dynamic model based controllers performs well for higher speed driving applications</p>
</li>
</ul>
<h2 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h2><p>this is an overview of self-driving car system. From a job-hunting view, the algorithms details are more important and better with some practial experience.</p>
<p><a href="https://www.mdpi.com/2075-1702/5/1/6/htm" target="_blank" rel="external">paper link</a> </p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/book-reading-ç¬¬ä¸€æœ¬æ— äººé©¾é©¶æŠ€æœ¯ä¹¦/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="David Z.J. Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serious Autonomous Vehicles">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/book-reading-ç¬¬ä¸€æœ¬æ— äººé©¾é©¶æŠ€æœ¯ä¹¦/" itemprop="url">book reading: ç¬¬ä¸€æœ¬æ— äººé©¾é©¶æŠ€æœ¯ä¹¦</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-27T05:39:51-04:00">
                2019-03-27
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/27/book-reading-ç¬¬ä¸€æœ¬æ— äººé©¾é©¶æŠ€æœ¯ä¹¦/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/03/27/book-reading-ç¬¬ä¸€æœ¬æ— äººé©¾é©¶æŠ€æœ¯ä¹¦/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ä¸€äº›æ–¹æ¡ˆ"><a href="#ä¸€äº›æ–¹æ¡ˆ" class="headerlink" title="ä¸€äº›æ–¹æ¡ˆ"></a>ä¸€äº›æ–¹æ¡ˆ</h2><ul>
<li>åŸºäºgps/imuèåˆçš„å®šä½</li>
<li>åŸºäºè§†è§‰çš„å®šä½</li>
<li>åŸºäºç‚¹äº‘çš„å®šä½</li>
<li>åŸºäºè§†è§‰çš„ç‰©ä½“è¯†åˆ«ä¸è·Ÿè¸ª</li>
<li>åŸºäºlidarçš„ç‰©ä½“è¯†åˆ«ä¸è·Ÿè¸ª</li>
</ul>
<h2 id="åŸºäºç‚¹äº‘çš„å®šä½"><a href="#åŸºäºç‚¹äº‘çš„å®šä½" class="headerlink" title="åŸºäºç‚¹äº‘çš„å®šä½"></a>åŸºäºç‚¹äº‘çš„å®šä½</h2><p>ç®€åŒ–æ¦‚ç‡é—®é¢˜ï¼šå·²çŸ¥t_0 æ—¶åˆ»çš„ç‚¹äº‘ä¿¡æ¯ï¼Œä»¥åŠt_1æ—¶åˆ»ï¼Œæ— äººè½¦ä½ç½®çš„å…ˆéªŒæ¦‚ç‡åˆ†å¸ƒï¼Œæ±‚æ— äººè½¦ä½ç½®çš„æ¦‚ç‡åˆ†å¸ƒã€‚</p>
<p>è´å¶æ–¯æ³•åˆ™:</p>
<p>  $$ P(X_t) =  P(Z_t | X_t ) \cdot \ \vec(P(X_t)) $$ </p>
<p>$\vec(P(X_t))$ æ˜¯æ±½è½¦å½“å‰ä½ç½®çš„æ¦‚ç‡åˆ†å¸ƒï¼› $P(Z_t | X_t)$ æ˜¯å½“å‰ä½ç½®ä¸‹è§‚å¯Ÿçš„ç‚¹äº‘æ¦‚ç‡åˆ†å¸ƒã€‚</p>
<h2 id="ROS-based-system"><a href="#ROS-based-system" class="headerlink" title="ROS based system"></a>ROS based system</h2><p>ROSæ˜¯åŸºäºæ¶ˆæ¯ä¼ é€’é€šä¿¡çš„ã€åˆ†å¸ƒå¼å¤šè¿›ç¨‹æ¡†æ¶ã€‚Topicå‘å¸ƒã€æ¥å—æ˜¯ä¸€ç§å¼‚æ­¥é€šä¿¡æ–¹å¼ï¼› ServiceæœåŠ¡æ˜¯ä¸€ç§åˆ©ç”¨åŒæ­¥é€šä¿¡è¯·æ±‚/å›å¤äº¤äº’çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p>
<h2 id="ä¼ æ„Ÿå™¨"><a href="#ä¼ æ„Ÿå™¨" class="headerlink" title="ä¼ æ„Ÿå™¨"></a>ä¼ æ„Ÿå™¨</h2><h3 id="Lidar"><a href="#Lidar" class="headerlink" title="Lidar"></a>Lidar</h3><ul>
<li>ç¯å¢ƒæ„ŸçŸ¥ï¼š é€šè¿‡é›·è¾¾æ‰«ææ±½è½¦å‘¨å›´çš„ç¯å¢ƒ3dæ¨¡å‹ã€‚è¿ç”¨ç›¸å…³ç®—æ³•æ¯”å¯¹ä¸Šä¸€å¸§å’Œä¸‹ä¸€å¸§ï¼Œä»è€ŒåŒ¹é…ç¯å¢ƒä¸­çš„å…¶ä»–è½¦è¾†æˆ–è¡Œäºº</li>
<li>slamå®šä½ï¼šå®æ—¶æ‰«æåœ°å›¾ï¼Œä¸é«˜ç²¾åœ°å›¾ä¸­çš„ç‰¹å¾ç‰©æ¯”å¯¹ï¼Œå®ç°å¯¼èˆªåŠç²¾å‡†å®šä½ã€‚</li>
<li>ä¾›åº”å•†ï¼š Velodyne </li>
</ul>
<h3 id="æ¯«ç±³æ³¢é›·è¾¾"><a href="#æ¯«ç±³æ³¢é›·è¾¾" class="headerlink" title="æ¯«ç±³æ³¢é›·è¾¾"></a>æ¯«ç±³æ³¢é›·è¾¾</h3><ul>
<li><p>å¯ç”¨å·¥ä½œé¢‘æ®µ 24ghzã€77ghz, æ³¢é•¿ 1 ï½ 10 mmã€‚77ghzç‰©ä½“åˆ†è¾¨ç‡è¾ƒ24ghzæé«˜2ï½4å€ï¼Œæµ‹é€Ÿå’Œæµ‹è·ç²¾åº¦æé«˜3~5å€ã€‚ç”µç£æ³¢é¢‘ç‡è¶Šé«˜ï¼Œè·ç¦»å’Œé€Ÿåº¦çš„æ£€æµ‹è§£æåº¦è¶Šé«˜ã€‚</p>
</li>
<li><p>ä¾›åº”å•†</p>
<p>   å°„é¢‘èŠ¯ç‰‡ï¼š24ghzæˆç†Ÿä¾›åº”ï¼ˆåšä¸–ã€é£æ€å¡å°”ï¼‰ï¼› 77ghzæ²¡æœ‰å¯¹ä¸­å›½å¼€æ”¾</p>
<p>   é›·è¾¾æ•°æ®å¤„ç†èŠ¯ç‰‡ï¼šæ©æ™ºæµ¦ï¼Œæ„è¡ŒåŠå¯¼ä½“</p>
</li>
</ul>
<h3 id="æ‘„åƒå¤´"><a href="#æ‘„åƒå¤´" class="headerlink" title="æ‘„åƒå¤´"></a>æ‘„åƒå¤´</h3><ul>
<li>é«˜åŠ¨æ€</li>
<li>ä¸­ä½åƒç´ </li>
<li>é€‚åˆæ¸©åº¦èŒƒå›´ -40 ï½ 80 åº¦</li>
<li>é˜²ç£æŠ—æŒ¯ </li>
<li>å¯¿å‘½é•¿</li>
</ul>
<h2 id="è®¡ç®—å¹³å°"><a href="#è®¡ç®—å¹³å°" class="headerlink" title="è®¡ç®—å¹³å°"></a>è®¡ç®—å¹³å°</h2><ul>
<li><p>è®¡ç®—å•å…ƒä¸è®¡ç®—è´Ÿè½½</p>
<p>  GPUæ‰§è¡Œå·ç§¯ä»»åŠ¡æœ€æœ‰æ•ˆï¼ŒDSPæ‰§è¡Œç‰¹å¾æå–æœ€æœ‰æ•ˆã€‚</p>
</li>
<li><p>ç§»åŠ¨ç«¯socæ¶æ„</p>
<p>  I/Oå­ç³»ç»Ÿä¸å‰ç«¯ä¼ æ„Ÿå™¨äº¤äº’ï¼›DSPè´Ÿè´£å›¾åƒå¤„ç†æµä»¥è¿›è¡Œç‰¹å¾æå–ï¼›ç”±GPUè¿›è¡Œç›®æ ‡è¯†åˆ«å’Œå…¶ä»–æ·±åº¦å­¦ä¹ ä»»åŠ¡ï¼›ç”±ä¸€ä¸ªå¤šæ ¸CPUå®Œæˆè§„åˆ’ã€æ§åˆ¶å’Œäº’åŠ¨çš„å­ä»»åŠ¡ï¼›ç”±FPGAè¿›è¡ŒåŠ¨æ€é‡æ„ä»¥åˆ†æ—¶å…±äº«çš„æ–¹å¼å®Œæˆä¼ æ„Ÿå™¨æ•°æ®å‹ç¼©ä¸Šä¼ ï¼Œç‰©ä½“è·Ÿè¸ªå’Œæµé‡é¢„æµ‹ç­‰ã€‚è®¡ç®—éƒ¨ä»¶å’ŒI/Oéƒ¨ä»¶ä¹‹é—´é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œæ•°æ®é€šä¿¡ã€‚</p>
</li>
</ul>
<h2 id="ç³»ç»Ÿå®‰å…¨"><a href="#ç³»ç»Ÿå®‰å…¨" class="headerlink" title="ç³»ç»Ÿå®‰å…¨"></a>ç³»ç»Ÿå®‰å…¨</h2><p>å®‰å…¨é—®é¢˜ï¼šå¼ºç£åœºå¹²æ‰°IMUï¼›å‡å¤§åŠŸç‡çš„gpsä¿¡å·ï¼›å¹²æ‰°æ¿€å…‰é›·è¾¾ï¼Œåœ¨æ— äººå¤„å‘¨å›´æ”¾ç½®å¼ºåå…‰ç‰©ï¼›å¹²æ‰°é«˜ç²¾åœ°å›¾çš„æ›´æ–°ï¼› rosç³»ç»ŸåŠ«æŒã€é€šä¿¡ä¿®æ”¹ã€‚obd-2å…¥ä¾µï¼Œ å……ç”µæ¡©å…¥ä¾µï¼Œè½¦è½½cdå…¥ä¾µï¼Œè“ç‰™å…¥ä¾µã€‚</p>
<h2 id="Sparkä¸ROSçš„åˆ†å¸ƒå¼æ¨¡æ‹Ÿå¹³å°"><a href="#Sparkä¸ROSçš„åˆ†å¸ƒå¼æ¨¡æ‹Ÿå¹³å°" class="headerlink" title="Sparkä¸ROSçš„åˆ†å¸ƒå¼æ¨¡æ‹Ÿå¹³å°"></a>Sparkä¸ROSçš„åˆ†å¸ƒå¼æ¨¡æ‹Ÿå¹³å°</h2><p>åŸºäºåˆæˆæ•°æ®çš„æ¨¡æ‹Ÿï¼›åŸºäºçœŸå®æ•°æ®å›æ”¾çš„æ¨¡æ‹Ÿã€‚</p>
<h2 id="é«˜ç²¾åœ°å›¾"><a href="#é«˜ç²¾åœ°å›¾" class="headerlink" title="é«˜ç²¾åœ°å›¾"></a>é«˜ç²¾åœ°å›¾</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="David Z.J. Lee" />
          <p class="site-author-name" itemprop="name">David Z.J. Lee</p>
           
              <p class="site-description motion-element" itemprop="description">what I don't know</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">151</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">34</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ZJLi2013" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/zhengjia13/" target="_blank" title="LinkedIn">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  LinkedIn
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">David Z.J. Lee</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://zjlee.disqus.com/count.js" async></script>
    

    

  




	





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

</body>
</html>
